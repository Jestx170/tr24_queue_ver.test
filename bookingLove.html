<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking - Valentine's Edition üíï</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
</head>
<body>
    <a href="index.html" class="back-link-float">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
        <span>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span>
    </a>

    <div class="container">
        <header>
            <img width="200" height="150" src="image/TR-removebg-preview.png" alt="Shoe Service Logo" class="header-logo">
            <p>üíï ‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡∏ã‡∏±‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤ üíï</p>
            <span class="valentine-badge">üåπ Valentine's Edition üåπ</span>
        </header>

        <form id="bookingForm">
            <!-- Phone -->
            <div class="form-group">
                <label>üì± ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ (Phone)</label>
                <input type="tel" name="phone" required placeholder="0xx-xxx-xxxx">
            </div>

            <hr>

            <!-- Pair Selector -->
            <div class="pair-selector">
                <h3>üëü ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤</h3>
                <div class="pair-buttons">
                    <div class="pair-btn active" onclick="selectPair(1)">
                        <span class="emoji">üëü</span>
                        <span>1 ‡∏Ñ‡∏π‡πà</span>
                        <div class="discount">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥</div>
                    </div>
                    <div class="pair-btn" onclick="selectPair(2)">
                        <span class="emoji">üëüüëü</span>
                        <span>2 ‡∏Ñ‡∏π‡πà</span>
                        <div class="discount">üíï ‡∏•‡∏î 10% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å!</div>
                    </div>
                </div>
            </div>

            <input type="hidden" name="pair_count" id="pairCount" value="1">

            <!-- Shoe 1 -->
            <div class="shoe-card" id="shoe1Card">
                <div class="shoe-card-header">
                    <div class="number">1</div>
                    <h4>‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 1 üíó</h4>
                </div>

                <div class="form-group">
                    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤ (Shoe Type)</label>
                    <select name="shoe_type_1" id="shoeType1" required onchange="calculateTotal()">
                        <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                        <option value="basketball" data-price="189">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ö‡∏≤‡∏™ (Basketball) - 189‡∏ø</option>
                        <option value="sneakers" data-price="189">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ú‡πâ‡∏≤‡πÉ‡∏ö (Sneakers) - 189‡∏ø</option>
                        <option value="suede" data-price="289">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ú‡πâ‡∏≤‡πÉ‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏Å‡∏•‡∏±‡∏ö (Suede) - 289‡∏ø</option>
                        <option value="leather" data-price="289">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏´‡∏ô‡∏±‡∏á (Leather) - 289‡∏ø</option>
                        <option value="sandals" data-price="79">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡πÅ‡∏ï‡∏∞ (Sandals) - 79‡∏ø</option>
                        <option value="other" data-price="189">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Other) - 189‡∏ø</option>
                    </select>
                </div>

                <div class="row">
                    <div class="form-group">
                        <label>‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå (Brand)</label>
                        <select name="brand_1" id="brand1" onchange="toggleOtherInput(1)">
                            <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                            <option value="nike">Nike</option>
                            <option value="adidas">Adidas</option>
                            <option value="puma">Puma</option>
                            <option value="mlb">MLB</option>
                            <option value="converse">Converse</option>
                            <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)</option>
                        </select>
                        <input type="text" name="brand_other_1" id="otherBrandInput1" 
                               placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠..." style="display: none; margin-top: 10px;">
                    </div>
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏∏‡πà‡∏ô (Model) <span style="color:#ff8fab; font-size:12px;">(‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</span></label>
                        <input type="text" name="model_1" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏∏‡πà‡∏ô (‡∏ñ‡πâ‡∏≤‡∏ó‡∏£‡∏≤‡∏ö)">
                    </div>
                </div>

                <div class="form-group">
                    <label> ‡∏£‡∏π‡∏õ‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 1</label>
                    <input type="file" id="productPicture1" accept="image/*" required>
                </div>
            </div>

            <!-- Shoe 2 -->
            <div class="shoe-card" id="shoe2Card">
                <div class="shoe-card-header">
                    <div class="number">2</div>
                    <h4>‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 2 üíó</h4>
                </div>

                <div class="form-group">
                    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤ (Shoe Type)</label>
                    <select name="shoe_type_2" id="shoeType2" onchange="calculateTotal()">
                        <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                        <option value="basketball" data-price="189">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ö‡∏≤‡∏™ (Basketball) - 189‡∏ø</option>
                        <option value="sneakers" data-price="189">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ú‡πâ‡∏≤‡πÉ‡∏ö (Sneakers) - 189‡∏ø</option>
                        <option value="suede" data-price="289">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ú‡πâ‡∏≤‡πÉ‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏Å‡∏•‡∏±‡∏ö (Suede) - 289‡∏ø</option>
                        <option value="leather" data-price="289">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏´‡∏ô‡∏±‡∏á (Leather) - 289‡∏ø</option>
                        <option value="sandals" data-price="79">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡πÅ‡∏ï‡∏∞ (Sandals) - 79‡∏ø</option>
                        <option value="other" data-price="189">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Other) - 189‡∏ø</option>
                    </select>
                </div>

                <div class="row">
                    <div class="form-group">
                        <label>‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå (Brand)</label>
                        <select name="brand_2" id="brand2" onchange="toggleOtherInput(2)">
                            <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                            <option value="nike">Nike</option>
                            <option value="adidas">Adidas</option>
                            <option value="puma">Puma</option>
                            <option value="mlb">MLB</option>
                            <option value="converse">Converse</option>
                            <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)</option>
                        </select>
                        <input type="text" name="brand_other_2" id="otherBrandInput2" 
                               placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠..." style="display: none; margin-top: 10px;">
                    </div>
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏∏‡πà‡∏ô (Model) <span style="color:#ff8fab; font-size:12px;">(‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</span></label>
                        <input type="text" name="model_2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏∏‡πà‡∏ô (‡∏ñ‡πâ‡∏≤‡∏ó‡∏£‡∏≤‡∏ö)">
                    </div>
                </div>

                <div class="form-group">
                    <label> ‡∏£‡∏π‡∏õ‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 2</label>
                    <input type="file" id="productPicture2" accept="image/*">
                </div>
            </div>

            <hr>

            <!-- Date & Address -->
            <div class="row">
                <div class="form-group">
                    <label>üìÖ ‡∏ß‡∏±‡∏ô‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤</label>
                    <input type="date" name="pickup_date" required>
                </div>
                <div class="form-group">
                    <label>üìÖ ‡∏ß‡∏±‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤ <span style="color:#ff8fab; font-size:12px;">*‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ 3 ‡∏ß‡∏±‡∏ô</span></label>
                    <input type="date" name="return_date" required>
                </div>
            </div>

            <div class="form-group">
                <label>üìç ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà / Google Maps</label>
                <textarea name="address" rows="3" placeholder="‡πÅ‡∏õ‡∏∞‡∏•‡∏¥‡∏á‡∏Å‡πå Google Maps ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á..." required></textarea>
            </div>

            <div class="form-group">
                <label>üìù Note / ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
                <textarea name="note" rows="2" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏≠‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÜ, ‡∏á‡∏≤‡∏ô‡∏î‡πà‡∏ß‡∏ô"></textarea>
            </div>

            <hr>

            <!-- Add-on Services -->
            <div class="addon-section">
                <h3> ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (Add-on Services)</h3>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label>‚ö° ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πà‡∏ß‡∏ô (Service Speed)</label>
                    <div class="radio-group">
                        <label class="radio-item">
                            <input type="radio" name="service_speed" value="0" checked onchange="calculateTotal()">
                            ‡∏õ‡∏Å‡∏ï‡∏¥ (Standard) <span class="price">+0.-</span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="service_speed" value="89" onchange="calculateTotal()">
                            ‡∏î‡πà‡∏ß‡∏ô 1-2 ‡∏ß‡∏±‡∏ô (Fast Track) <span class="price">+89.-</span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="service_speed" value="129" onchange="calculateTotal()">
                            ‡∏î‡πà‡∏ß‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© 1 ‡∏ß‡∏±‡∏ô (Super Fast) <span class="price">+129.-</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label> ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏© (Extra Care)</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" id="chk_yellow" value="299" onchange="calculateTotal()">
                            ‡πÅ‡∏Å‡πâ‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á (Un-Yellowing) <span class="price">+299.-</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="chk_ozone" value="159" onchange="calculateTotal()">
                            ‡∏≠‡∏ö‡πÇ‡∏≠‡πÇ‡∏ã‡∏ô‡∏Ü‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πâ‡∏≠ (Ozone) <span class="price">+159.-</span>
                        </label>
                    </div>
                </div>

                <div class="total-price-box">
                    <span>üíï ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô (Total)</span>
                    <span class="price-text" id="displayTotal">189</span>
                    <span style="font-size:18px;">‡∏ö‡∏≤‡∏ó</span>
                    <div class="discount-info" id="discountInfo" style="display: none;">
                         ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 10% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å!
                    </div>
                </div>
            </div>

            <button type="button" class="btn-payment" onclick="openPaymentModal()">
                 ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
            </button>

            <!-- Payment Modal -->
            <div id="paymentModal" class="modal">
                <div class="modal-content">
                    <h3> ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (Payment)</h3>
                    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</p>
                    
                    <img width="230" src="image/‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô.png" alt="PromptPay QR" class="qr-img">
                    
                    <div class="form-group" style="text-align: left; margin-top: 20px;">
                        <label>üìé ‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (Upload Slip)</label>
                        <input type="file" id="slipFile" accept="image/*" required>
                        <p class="note-text">*‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Google Drive ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô</p>
                    </div>
                    
                    <button type="submit" id="finalSubmit" class="btn-submit">
                         ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                    <button type="button" class="btn-close-modal" onclick="closePaymentModal()">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner-box">
            <div class="spinner"></div>
            <p> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...</p>
            <p style="font-size: 12px; color: #ff8fab;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà ‡∏≠‡∏¢‡πà‡∏≤‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</p>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyoPBfY70KXz05VX25r9ImIRQ_8eYlvWDCMWAz7TvN9mAk5UOujEYdi0VgYrc_V7KHXCg/exec';
        const form = document.getElementById('bookingForm');
        const btn = document.getElementById('finalSubmit');
        const loadingOverlay = document.getElementById('loadingOverlay');
        
        let selectedPairs = 1;
    
        // Select number of pairs
        function selectPair(num) {
            selectedPairs = num;
            document.getElementById('pairCount').value = num;
            
            // Update button styles
            document.querySelectorAll('.pair-btn').forEach((btn, index) => {
                if (index + 1 === num) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Show/hide shoe 2 card
            const shoe2Card = document.getElementById('shoe2Card');
            const productPicture2 = document.getElementById('productPicture2');
            const shoeType2 = document.getElementById('shoeType2');
            
            if (num === 2) {
                shoe2Card.style.display = 'block';
                productPicture2.setAttribute('required', 'required');
                shoeType2.setAttribute('required', 'required');
            } else {
                shoe2Card.style.display = 'none';
                productPicture2.removeAttribute('required');
                shoeType2.removeAttribute('required');
                // Clear values when hiding
                shoeType2.value = '';
                document.getElementById('brand2').value = '';
                document.querySelector('[name="model_2"]').value = '';
            }
            
            // Show/hide discount info
            document.getElementById('discountInfo').style.display = num === 2 ? 'inline-block' : 'none';
            
            calculateTotal();
        }
    
        // Toggle other brand input
        function toggleOtherInput(shoeNum) {
            const selectBox = document.getElementById('brand' + shoeNum);
            const otherInput = document.getElementById('otherBrandInput' + shoeNum);
    
            if (selectBox.value === 'other') {
                otherInput.style.display = 'block';
                otherInput.setAttribute('required', 'required');
            } else {
                otherInput.style.display = 'none';
                otherInput.value = '';
                otherInput.removeAttribute('required');
            }
        }
    
        // Calculate total price
        function calculateTotal() {
            let total = 0;
            
            // Shoe 1 price
            const shoeType1 = document.getElementById('shoeType1');
            if (shoeType1.selectedIndex > 0) {
                const price1 = parseInt(shoeType1.options[shoeType1.selectedIndex].dataset.price) || 189;
                total += price1;
            } else {
                total += 189; // Default price
            }
            
            // Shoe 2 price (if selected)
            if (selectedPairs === 2) {
                const shoeType2 = document.getElementById('shoeType2');
                if (shoeType2.selectedIndex > 0) {
                    const price2 = parseInt(shoeType2.options[shoeType2.selectedIndex].dataset.price) || 189;
                    total += price2;
                } else {
                    total += 189; // Default price
                }
            }
            
            // Service speed
            const speedRadios = document.getElementsByName('service_speed');
            for (const radio of speedRadios) {
                if (radio.checked) {
                    total += parseInt(radio.value);
                    break;
                }
            }
            
            // Extra services
            const chkYellow = document.getElementById('chk_yellow');
            const chkOzone = document.getElementById('chk_ozone');
            if (chkYellow && chkYellow.checked) total += 299;
            if (chkOzone && chkOzone.checked) total += 159;
            
            // Apply 10% discount for 2 pairs (Valentine's special!)
            if (selectedPairs === 2) {
                total = Math.round(total * 0.9);
            }
            
            document.getElementById('displayTotal').innerText = total.toLocaleString();
            return total;
        }
    
        // ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ - Open payment modal
        function openPaymentModal() {
            // Validate manually
            let errors = [];
            
            // Check phone
            if (!form.phone.value.trim()) {
                errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£");
            }
            
            // Check shoe type 1
            if (!form.shoe_type_1.value) {
                errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 1");
            }
            
            // Check product picture 1
            const productPicture1 = document.getElementById('productPicture1');
            if (!productPicture1.files || !productPicture1.files[0]) {
                errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 1");
            }
            
            // Check shoe 2 if selected 2 pairs
            if (selectedPairs === 2) {
                if (!form.shoe_type_2.value) {
                    errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 2");
                }
                
                const productPicture2 = document.getElementById('productPicture2');
                if (!productPicture2.files || !productPicture2.files[0]) {
                    errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 2");
                }
            }
            
            // Check brand other input
            if (form.brand_1.value === 'other' && !form.brand_other_1.value.trim()) {
                errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 1");
            }
            
            if (selectedPairs === 2 && form.brand_2.value === 'other' && !form.brand_other_2.value.trim()) {
                errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà 2");
            }
            
            // Check dates
            if (!form.pickup_date.value) {
                errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤");
            }
            
            if (!form.return_date.value) {
                errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤");
            }
            
            // Check address
            if (!form.address.value.trim()) {
                errors.push("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà");
            }
            
            // If there are errors, show them
            if (errors.length > 0) {
                Swal.fire({
                    icon: 'warning',
                    title: ' ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö',
                    html: errors.map(e => `‚Ä¢ ${e}`).join('<br>'),
                    confirmButtonColor: '#ff6b95'
                });
                return;
            }
            
            // All valid - open modal
            document.getElementById('paymentModal').style.display = 'flex';
        }
    
        // Close payment modal
        function closePaymentModal() {
            document.getElementById('paymentModal').style.display = 'none';
        }
    
        // Close modal when clicking outside
        document.getElementById('paymentModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closePaymentModal();
            }
        });
    
        // Form submission
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Check slip file
            const slipInput = document.getElementById('slipFile');
            if (!slipInput.files || !slipInput.files[0]) {
                Swal.fire({
                    icon: 'warning',
                    title: ' ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ',
                    text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
                    confirmButtonColor: '#ff6b95'
                });
                return;
            }
            
            btn.innerHTML = " ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î...";
            btn.disabled = true;
            loadingOverlay.style.display = 'flex';
    
            const toBase64 = file => new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve({
                    base64: reader.result.split(',')[1],
                    name: file.name,
                    type: file.type
                });
                reader.onerror = error => reject(error);
            });
    
            try {
                const productInput1 = document.getElementById('productPicture1');
                const productInput2 = document.getElementById('productPicture2');
    
                const productFileData1 = await toBase64(productInput1.files[0]);
                const slipFileData = await toBase64(slipInput.files[0]);
                
                let productFileData2 = null;
                if (selectedPairs === 2 && productInput2.files[0]) {
                    productFileData2 = await toBase64(productInput2.files[0]);
                }
    
                // Get service speed text
                const speedRadio = document.querySelector('input[name="service_speed"]:checked');
                let serviceSpeedText = "‡∏õ‡∏Å‡∏ï‡∏¥ (Standard)";
                if (speedRadio) {
                    serviceSpeedText = speedRadio.parentElement.innerText.replace(/\s+/g, ' ').trim();
                }
    
                // Get addons
                let addons = [];
                if (document.getElementById('chk_yellow')?.checked) addons.push("‡πÅ‡∏Å‡πâ‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á");
                if (document.getElementById('chk_ozone')?.checked) addons.push("‡∏≠‡∏ö‡πÇ‡∏≠‡πÇ‡∏ã‡∏ô");
                const addonsText = addons.length > 0 ? addons.join(", ") : "-";
    
                // Get brand values
                const brand1 = form.brand_1.value === 'other' ? form.brand_other_1.value : form.brand_1.value;
                const brand2 = selectedPairs === 2 ? 
                    (form.brand_2.value === 'other' ? form.brand_other_2.value : form.brand_2.value) : '';
    
                const payload = {
                    phone: form.phone.value,
                    pair_count: selectedPairs,
                    
                    // Shoe 1
                    shoe_type_1: form.shoe_type_1.value,
                    brand_1: brand1,
                    model_1: form.model_1.value || '-',
                    
                    // Shoe 2
                    shoe_type_2: selectedPairs === 2 ? form.shoe_type_2.value : '-',
                    brand_2: brand2 || '-',
                    model_2: selectedPairs === 2 ? (form.model_2.value || '-') : '-',
                    
                    pickup_date: form.pickup_date.value,
                    return_date: form.return_date.value,
                    address: form.address.value,
                    note: form.note.value || '-',
                    service_speed: serviceSpeedText,
                    addon_services: addonsText,
                    total_price: calculateTotal(),
                    valentine_discount: selectedPairs === 2 ? '10%' : '‡πÑ‡∏°‡πà‡∏°‡∏µ',
                    
                    // Files
                    productFile1: productFileData1.base64,
                    productFileName1: productFileData1.name,
                    productMimeType1: productFileData1.type,
                    
                    productFile2: productFileData2 ? productFileData2.base64 : '',
                    productFileName2: productFileData2 ? productFileData2.name : '',
                    productMimeType2: productFileData2 ? productFileData2.type : '',
                    
                    slipFile: slipFileData.base64,
                    slipFileName: slipFileData.name,
                    slipMimeType: slipFileData.type
                };
    
                console.log('Sending payload:', payload); // Debug
    
                const response = await fetch(scriptURL, { 
                    method: 'POST', 
                    body: JSON.stringify(payload) 
                });
    
                const result = await response.json();
                loadingOverlay.style.display = 'none';
                closePaymentModal();
    
                if (result.result === 'success') {
                    Swal.fire({
                        title: '‡∏à‡∏≠‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!',
                        text: selectedPairs === 2 ? 
                            '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á 2 ‡∏Ñ‡∏π‡πà ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 10%!' : 
                            '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                        icon: 'success',
                        confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                        confirmButtonColor: '#ff6b95'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href = "index.html";
                        }
                    });
                } else {
                    throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà server');
                }
    
            } catch (error) {
                console.error('Error:', error);
                loadingOverlay.style.display = 'none';
                Swal.fire({
                    icon: 'error',
                    title: ' ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                    text: error.message,
                    confirmButtonColor: '#ff6b95'
                });
            } finally {
                btn.innerHTML = "‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                btn.disabled = false;
            }
        });
    
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            calculateTotal();
            
            // Set min date to today
            const today = new Date().toISOString().split('T')[0];
            document.querySelector('[name="pickup_date"]').setAttribute('min', today);
            document.querySelector('[name="return_date"]').setAttribute('min', today);
        });
    </script>
</body>

</html>
